{"componentChunkName":"component---src-templates-blog-post-js","path":"/java-excel-poi/","result":{"data":{"site":{"siteMetadata":{"title":"Evil Mouth's Blog"}},"markdownRemark":{"id":"cc9efdbb-0be2-5782-9f90-6437f8556fff","excerpt":"比较出名的两个方案jxi和poi，由于jxi只适用Excel 2003，所以肯定选择poi，但是poi又跟android不兼容，不能通过maven依赖方式拉取，所以只能自己重新打包jar文件并导入到项目中才可以使用，在网上找了下找到个3-12版的，现在官网最新的是3-1…","html":"<p>比较出名的两个方案jxi和poi，由于jxi只适用Excel 2003，所以肯定选择poi，但是poi又跟android不兼容，不能通过maven依赖方式拉取，所以只能自己重新打包jar文件并导入到项目中才可以使用，在网上找了下找到个3-12版的，现在官网最新的是3-16，不过之前由于急着弄这个功能就没管了，后面找个时间自己打包下，jar包可以在下面链接找到</p>\n<p><a href=\"https://github.com/izyhang/ExcelPoi\">https://github.com/izyhang/ExcelPoi</a></p>\n<!-- More -->\n<h3>读写Excel</h3>\n<p>读写操作还是很常规的</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">InputStream</span> is <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Workbook</span> wookbook <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span>is<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//Excel 2007</span>\n<span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> wookbook<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<h3>取单元格内容</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getCellFormatValue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Cell</span> cell<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 判断当前Cell的Type</span>\n        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span><span class=\"token function\">getCellType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// 如果当前Cell的Type为NUMERIC</span>\n            <span class=\"token keyword\">case</span> <span class=\"token class-name\">Cell</span><span class=\"token punctuation\">.</span>CELL_TYPE_NUMERIC<span class=\"token operator\">:</span>\n                <span class=\"token comment\">// 判断当前的cell是否为Date</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">HSSFDateUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">isCellDateFormatted</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token comment\">// 方法2：这样子的data格式是不带带时分秒的：2011-10-12</span>\n                    <span class=\"token keyword\">double</span> date <span class=\"token operator\">=</span> cell<span class=\"token punctuation\">.</span><span class=\"token function\">getNumericCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token class-name\">SimpleDateFormat</span> sdf <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDateFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"yyyy/MM/dd HH:mm\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Locale</span><span class=\"token punctuation\">.</span>CHINA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    value <span class=\"token operator\">=</span> sdf<span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HSSFDateUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">getJavaDate</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token comment\">// 如果是纯数字通过NumberToTextConverter.toText(double)将double转成string</span>\n                    value <span class=\"token operator\">=</span> <span class=\"token class-name\">NumberToTextConverter</span><span class=\"token punctuation\">.</span><span class=\"token function\">toText</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span><span class=\"token function\">getNumericCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// 如果当前Cell的Type为STRING</span>\n            <span class=\"token keyword\">case</span> <span class=\"token class-name\">Cell</span><span class=\"token punctuation\">.</span>CELL_TYPE_STRING<span class=\"token operator\">:</span>\n                <span class=\"token comment\">// 取得当前的Cell字符串</span>\n                value <span class=\"token operator\">=</span> cell<span class=\"token punctuation\">.</span><span class=\"token function\">getStringCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// 如果当前Cell的Type为BOOLEAN</span>\n            <span class=\"token keyword\">case</span> <span class=\"token class-name\">Cell</span><span class=\"token punctuation\">.</span>CELL_TYPE_BOOLEAN<span class=\"token operator\">:</span>\n                value <span class=\"token operator\">=</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span><span class=\"token function\">getBooleanCellValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> value<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p>这里读纯数字用的是<code class=\"language-text\">NumberToTextConverter.toText</code>，具体看实际需求</p>","frontmatter":{"title":"使用POI读写Excel","date":"May 27, 2017","tags":["poi"],"categories":"Java"}}},"pageContext":{"slug":"/java-excel-poi/","previous":{"fields":{"slug":"/java-shell-command/"},"frontmatter":{"title":"在java中调用shell命令"}},"next":{"fields":{"slug":"/bubble-of-seekbar/"},"frontmatter":{"title":"为SeekBar添加滑动跟随气泡"}}}},"staticQueryHashes":["2841359383"]}