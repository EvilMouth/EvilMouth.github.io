{"componentChunkName":"component---src-templates-blog-post-js","path":"/amazon-s3-post-upload-policy/","result":{"data":{"site":{"siteMetadata":{"title":"Evil Mouth's Blog"}},"markdownRemark":{"id":"d062c5ef-76c5-51f1-941a-1c95db83c15b","excerpt":"前言 最近在写后端，需要后端生成给前端直接上传文件到，减轻服务器压力，记录一下踩的坑，附上官方文档\nhttps://docs.aws.amazon.com/zh_cn/AmazonS3/latest/API/sigv4-UsingHTTPPOST.html…","html":"<h2>前言</h2>\n<p>最近在写后端，需要后端生成<code class=\"language-text\">token</code>给前端直接上传文件到<code class=\"language-text\">S3</code>，减轻服务器压力，记录一下踩的坑，附上官方文档\n<a href=\"https://docs.aws.amazon.com/zh_cn/AmazonS3/latest/API/sigv4-UsingHTTPPOST.html\">https://docs.aws.amazon.com/zh_cn/AmazonS3/latest/API/sigv4-UsingHTTPPOST.html</a></p>\n<!-- More -->\n<h2>上传策略</h2>\n<p>第一步就是要创建上传策略，官方提供的模板是这样的，根据自己需要增加或减少策略属性，最终将这么一串策略进行<code class=\"language-text\">base64</code>编码一下得到<code class=\"language-text\">StringToSign</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span> <span class=\"token property\">\"expiration\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2015-12-30T12:00:00.000Z\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"conditions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span><span class=\"token property\">\"bucket\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sigv4examplebucket\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">\"starts-with\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"$key\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"user/user1/\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token property\">\"acl\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"public-read\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token property\">\"success_action_redirect\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http://sigv4examplebucket.s3.amazonaws.com/successful_upload.html\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">\"starts-with\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"$Content-Type\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"image/\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token property\">\"x-amz-meta-uuid\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"14365123651274\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token property\">\"x-amz-server-side-encryption\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"AES256\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">\"starts-with\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"$x-amz-meta-tag\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token punctuation\">{</span><span class=\"token property\">\"x-amz-credential\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"AKIAIOSFODNN7EXAMPLE/20151229/us-east-1/s3/aws4_request\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token property\">\"x-amz-algorithm\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"AWS4-HMAC-SHA256\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token property\">\"x-amz-date\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"20151229T000000Z\"</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>那好吧，这么一串<code class=\"language-text\">json</code>属性又多，格式又乱，那应该有提供生成器吧，结果看了半天api文档都没找到（可能是我眼花了，有找到的朋友告知一下谢谢），介绍文档也只是说需要怎么操作，并没有提供工具。那只好自己来生成，我的思路是在本地新建个<code class=\"language-text\">policy.json</code>文件，将我需要的最终策略的<code class=\"language-text\">json</code>形式复制在里面，然后代码读取动态替换掉<code class=\"language-text\">value</code>，类似这样：<code class=\"language-text\">string.replaceAll(&quot;replace-bucket&quot;, bucket)</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"expiration\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"replace-expiration\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"conditions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"bucket\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"replace-bucket\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"starts-with\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"$key\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"replace-dir\"</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"acl\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"replace-acl\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>最后<code class=\"language-text\">base64</code>一下就拿到<code class=\"language-text\">StringToSign</code>，后面签署签名的时候要用到</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// BinaryUtils是amazon sdk提供的工具</span>\n<span class=\"token class-name\">String</span> encodePolicy <span class=\"token operator\">=</span> <span class=\"token class-name\">BinaryUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBase64</span><span class=\"token punctuation\">(</span>policy<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>签名key</h2>\n<p>创建完<code class=\"language-text\">policy</code>之后就是创建<code class=\"language-text\">签名key</code>了，这一步文档倒是说得比较明白</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 510px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3a5a5bbfcd1fd05a14dd6f93186e5670/18815/1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHrvHQKVD//xAAaEAACAgMAAAAAAAAAAAAAAAAAAQISESFB/9oACAEBAAEFAu3LmWQ2j//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABMSD/2gAIAQEABj8CZCY//8QAGxAAAgEFAAAAAAAAAAAAAAAAAAERECExQWH/2gAIAQEAAT8hnQxdBwEWGM7lP//aAAwDAQACAAMAAAAQo8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEBAQACAwAAAAAAAAAAAAABEQAQIUFxgf/aAAgBAQABPxBIyqeSl1Q9XeZSn7r+0uqXW8f/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jsdelivr\"\n        title=\"jsdelivr\"\n        src=\"/static/3a5a5bbfcd1fd05a14dd6f93186e5670/18815/1.jpg\"\n        srcset=\"/static/3a5a5bbfcd1fd05a14dd6f93186e5670/a80bd/1.jpg 148w,\n/static/3a5a5bbfcd1fd05a14dd6f93186e5670/1c91a/1.jpg 295w,\n/static/3a5a5bbfcd1fd05a14dd6f93186e5670/18815/1.jpg 510w\"\n        sizes=\"(max-width: 510px) 100vw, 510px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>官方也有提供对应的<code class=\"language-text\">HMAC-SHA256</code></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token class-name\">HmacSHA256</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> data<span class=\"token punctuation\">,</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> key<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> algorithm <span class=\"token operator\">=</span> <span class=\"token string\">\"HmacSHA256\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Mac</span> mac <span class=\"token operator\">=</span> <span class=\"token class-name\">Mac</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span>algorithm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mac<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">SecretKeySpec</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> algorithm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> mac<span class=\"token punctuation\">.</span><span class=\"token function\">doFinal</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token function\">getSignatureKey</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> dateStamp<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> regionName<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> serviceName<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> kSecret <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"AWS4\"</span> <span class=\"token operator\">+</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> kDate <span class=\"token operator\">=</span> <span class=\"token class-name\">HmacSHA256</span><span class=\"token punctuation\">(</span>dateStamp<span class=\"token punctuation\">,</span> kSecret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> kRegion <span class=\"token operator\">=</span> <span class=\"token class-name\">HmacSHA256</span><span class=\"token punctuation\">(</span>regionName<span class=\"token punctuation\">,</span> kDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> kService <span class=\"token operator\">=</span> <span class=\"token class-name\">HmacSHA256</span><span class=\"token punctuation\">(</span>serviceName<span class=\"token punctuation\">,</span> kRegion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> kSigning <span class=\"token operator\">=</span> <span class=\"token class-name\">HmacSHA256</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"aws4_request\"</span><span class=\"token punctuation\">,</span> kService<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> kSigning<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>key : AWSAccessKeySecret</li>\n<li>dateStamp : 过期日期，需要跟策略的credential date一致</li>\n<li>regionName : 服务地区名称<a href=\"https://docs.aws.amazon.com/zh_cn/general/latest/gr/rande.html#s3_region\">https://docs.aws.amazon.com/zh<em>cn/general/latest/gr/rande.html#s3</em>region</a></li>\n<li>serviceName : AWS服务名称，这里是s3</li>\n</ul>\n<h2>签名</h2>\n<p>最后一步就是拿着<code class=\"language-text\">签名key</code>签署<code class=\"language-text\">StringToSign</code>，还是用官方提供的<code class=\"language-text\">HMAC-SHA256</code>，最终得到的是<code class=\"language-text\">byte[]</code>类型的签名，需要转换成<code class=\"language-text\">string</code>类型</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token function\">byte2hex</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> b<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">StringBuilder</span> hs <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StringBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">String</span> stmp<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> b <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> n <span class=\"token operator\">&lt;</span> b<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> n<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        stmp <span class=\"token operator\">=</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHexString</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0XFF</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>stmp<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n            hs<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        hs<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>stmp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> hs<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>这里也是要注意签名的大小写，弄了半天大写一直说签名不对</li>\n</ul>\n<h2>签名例子</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">String</span> policy <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">String</span> encodePolicy <span class=\"token operator\">=</span> <span class=\"token class-name\">BinaryUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBase64</span><span class=\"token punctuation\">(</span>policy<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> bytes <span class=\"token operator\">=</span> <span class=\"token function\">getSignatureKey</span><span class=\"token punctuation\">(</span>accessKeySecret<span class=\"token punctuation\">,</span> <span class=\"token string\">\"20180606\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ap-southeast-1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"s3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">String</span> signature <span class=\"token operator\">=</span> <span class=\"token function\">byte2hex</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HmacSHA256</span><span class=\"token punctuation\">(</span>encodePolicy<span class=\"token punctuation\">,</span> bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>返回数据</h2>\n<p>根据上面三步拿到两个<code class=\"language-text\">POST</code>上传需要的东西<code class=\"language-text\">encode-policy</code>和<code class=\"language-text\">signature</code>，然后将其他策略条件一并返回给前端，让前端直接将文件上传到<code class=\"language-text\">s3</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/242d08c63ff3b6e066fc53b293384981/f0b2f/2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.45945945945947%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe5YNILkNg//xAAYEAACAwAAAAAAAAAAAAAAAAABEAARMf/aAAgBAQABBQISkGMX/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwIf/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAEQESExQVH/2gAIAQEAAT8ho0LIpGp0uL2P/9oADAMBAAIAAwAAABDTwDz/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAeEAEAAgIBBQAAAAAAAAAAAAABABEhMVEQQXGBkf/aAAgBAQABPxACsy5xAtjF89I2IoO9XxAhQvya/c7+bDRP/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jsdelivr\"\n        title=\"jsdelivr\"\n        src=\"/static/242d08c63ff3b6e066fc53b293384981/1c72d/2.jpg\"\n        srcset=\"/static/242d08c63ff3b6e066fc53b293384981/a80bd/2.jpg 148w,\n/static/242d08c63ff3b6e066fc53b293384981/1c91a/2.jpg 295w,\n/static/242d08c63ff3b6e066fc53b293384981/1c72d/2.jpg 590w,\n/static/242d08c63ff3b6e066fc53b293384981/a8a14/2.jpg 885w,\n/static/242d08c63ff3b6e066fc53b293384981/f0b2f/2.jpg 1078w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"亚马逊S3`POST`上传策略","date":"June 07, 2018","description":"亚马逊S3`POST`上传策略"}}},"pageContext":{"slug":"/amazon-s3-post-upload-policy/","previous":null,"next":{"fields":{"slug":"/alipay-tinyapp-zhi-ding-ye-mian-tiao-zhuan/"},"frontmatter":{"title":"支付宝小程序指定页面跳转"}}}},"staticQueryHashes":["240262808","2841359383"]}