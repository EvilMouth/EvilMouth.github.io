{"componentChunkName":"component---src-templates-blog-post-js","path":"/fa-bu-android-ku-dao-github-packages/","result":{"data":{"site":{"siteMetadata":{"title":"Evil Mouth","author":{"name":"Evil Mouth"}}},"markdownRemark":{"id":"406bc4ae-d42f-5a2c-a2cc-d6d1c9f0fff7","excerpt":"原文：https://proandroiddev.com/publishing-android-libraries-to-the-github-package-registry-part-1-7997be54ea5a 推出了自己的包管理服务，目前开源项目免费使用，提供、、、、、，更多信息可以在这里找到 About…","html":"<p>原文：<a href=\"https://proandroiddev.com/publishing-android-libraries-to-the-github-package-registry-part-1-7997be54ea5a\">https://proandroiddev.com/publishing-android-libraries-to-the-github-package-registry-part-1-7997be54ea5a</a></p>\n<!-- More -->\n<p><code class=\"language-text\">GitHub</code>推出了自己的包管理服务，目前开源项目免费使用，提供<code class=\"language-text\">npm</code>、<code class=\"language-text\">gem</code>、<code class=\"language-text\">mvn</code>、<code class=\"language-text\">gradle</code>、<code class=\"language-text\">docker</code>、<code class=\"language-text\">dotnet</code>，更多信息可以在这里找到 <a href=\"https://help.github.com/en/packages/publishing-and-managing-packages/about-github-packages\">About GitHub Packages</a></p>\n<h2>Part 1 - 发布</h2>\n<h3>Step 1 - 生成 GitHub Personal Access Token</h3>\n<ul>\n<li>在你的 GitHub 账户里</li>\n<li>进入 Settings -> Developer Settings -> Personal Access Tokens -> Generate new token</li>\n<li>勾选<code class=\"language-text\">write:packages</code>和<code class=\"language-text\">read:packages</code>生成一个 Token\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/17896d7a2407f8d800198c6e9e158f8c/e5166/1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.864864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAADABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdyQqD//xAAWEAADAAAAAAAAAAAAAAAAAAAAAhD/2gAIAQEAAQUCjH//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAXEAEBAQEAAAAAAAAAAAAAAAABABEh/9oACAEBAAE/IQMYCHb/2gAMAwEAAgADAAAAEAAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAMAAwAAAAAAAAAAAAAAAQAhMRFRkf/aAAgBAQABPxDIGEAlHkDjRnU//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/17896d7a2407f8d800198c6e9e158f8c/1c72d/1.jpg\"\n        srcset=\"/static/17896d7a2407f8d800198c6e9e158f8c/a80bd/1.jpg 148w,\n/static/17896d7a2407f8d800198c6e9e158f8c/1c91a/1.jpg 295w,\n/static/17896d7a2407f8d800198c6e9e158f8c/1c72d/1.jpg 590w,\n/static/17896d7a2407f8d800198c6e9e158f8c/a8a14/1.jpg 885w,\n/static/17896d7a2407f8d800198c6e9e158f8c/fbd2c/1.jpg 1180w,\n/static/17896d7a2407f8d800198c6e9e158f8c/e5166/1.jpg 1200w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></li>\n<li>生成 Token 后记得复制保存，该 Token 只显示在这一次，之后只能重新生成新的 Token</li>\n</ul>\n<h3>Step 2 - 配置 Token 到你的项目</h3>\n<ul>\n<li>在你的项目根目录新建一个<code class=\"language-text\">.properties</code>文件，比如<code class=\"language-text\">github.properties</code></li>\n<li>添加两个属性<code class=\"language-text\">gpr.usr=GITHUB_USERID</code> <code class=\"language-text\">gpr.key=PERSONAL_ACCESS_TOKEN</code></li>\n<li><code class=\"language-text\">GITHUB_USERID</code>替换成你的 GitHub 账户 Id，<code class=\"language-text\">PERSONAL_ACCESS_TOKEN</code>替换成 Step 1 生成的 Token</li>\n<li>如果你的项目是开源项目，记得将<code class=\"language-text\">.properties</code>文件添加到<code class=\"language-text\">.gitignore</code>，以免泄露 Token</li>\n</ul>\n<blockquote>\n<p>你也可以通过环境变量来传入<code class=\"language-text\">GPR_USER</code>和<code class=\"language-text\">GPR_API_KEY</code>，就不需要<code class=\"language-text\">.properties</code>文件</p>\n</blockquote>\n<h3>Step 3 - 更新 library module 的 build.gradle</h3>\n<ul>\n<li>将下方代码添加到 library module 的 build.gradle 文件</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"gradle\"><pre class=\"language-gradle\"><code class=\"language-gradle\">apply plugin: &#39;maven-publish&#39; // 添加到library build.gradle的最上面\n\ndef githubProperties = new Properties()\ngithubProperties.load(new FileInputStream(rootProject.file(&quot;github.properties&quot;)))\n\ndef getVersionName = { -&gt;\n return &quot;1.0.2&quot; // 仓库版本\n}\n\ndef getArtificatId = { -&gt;\n return &quot;sampleAndroidLib&quot; // 仓库Id\n}\n\npublishing {\n publications {\n   bar(MavenPublication) {\n      groupId &#39;com.enefce.libraries&#39; // 仓库组Id\n      artifactId getArtificatId()\n      version getVersionName()\n      artifact(&quot;$buildDir/outputs/aar/${getArtificatId()}-release.aar&quot;)\n    }\n }\n\nrepositories {\n        maven {\n               name = &quot;GitHubPackages&quot;\n        /** Configure path of your package repository on Github\n         ** GITHUB_USERID替换成你的GitHub账户Id\n         ** REPOSITORY替换成你的项目名称\n        */\n url = uri(&quot;https://maven.pkg.github.com/GITHUB_USERID/REPOSITORY&quot;)\ncredentials {\n        /** Create github.properties in root project folder file with\n         ** gpr.usr=GITHUB_USER_ID &amp; gpr.key=PERSONAL_ACCESS_TOKEN\n         ** Set env variable GPR_USER &amp; GPR_API_KEY if not adding a properties file**/\n\n         username = githubProperties[&#39;gpr.usr&#39;] ?: System.getenv(&quot;GPR_USER&quot;)\n         password = githubProperties[&#39;gpr.key&#39;] ?: System.getenv(&quot;GPR_API_KEY&quot;)\n      }\n    }\n  }\n}</code></pre></div>\n<h3>Step 4 - 执行发布</h3>\n<blockquote>\n<p>在执行发布之前需要确保编译过，也就是<code class=\"language-text\">build</code>命令，并能在<code class=\"language-text\">build/outputs/aar/</code>路径找到编译后的 aar 文件</p>\n</blockquote>\n<ul>\n<li>在你的 library module 任务下找到<code class=\"language-text\">publishing/publish</code>并执行，或者直接命令行</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ gradle publish</code></pre></div>\n<ul>\n<li>当任务成功后就可以在你的 GitHub 账户下的<code class=\"language-text\">Packages</code>栏找到该包\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e9386d50d97d62424a3aa8ecd2852199/e5166/2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.675675675675674%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3KCAf//EABYQAAMAAAAAAAAAAAAAAAAAAAABEP/aAAgBAQABBQKM/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGRABAAIDAAAAAAAAAAAAAAAAAQARITFR/9oACAEBAAE/IQEMEo5CXqf/2gAMAwEAAgADAAAAEHPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBAAAgAHAAAAAAAAAAAAAAAAACEBETFBUWGR/9oACAEBAAE/EEkKFjU4SBKYP//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2\"\n        title=\"2\"\n        src=\"/static/e9386d50d97d62424a3aa8ecd2852199/1c72d/2.jpg\"\n        srcset=\"/static/e9386d50d97d62424a3aa8ecd2852199/a80bd/2.jpg 148w,\n/static/e9386d50d97d62424a3aa8ecd2852199/1c91a/2.jpg 295w,\n/static/e9386d50d97d62424a3aa8ecd2852199/1c72d/2.jpg 590w,\n/static/e9386d50d97d62424a3aa8ecd2852199/a8a14/2.jpg 885w,\n/static/e9386d50d97d62424a3aa8ecd2852199/fbd2c/2.jpg 1180w,\n/static/e9386d50d97d62424a3aa8ecd2852199/e5166/2.jpg 1200w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></li>\n<li>如果任务失败，可以跟<code class=\"language-text\">–stacktrace</code>、<code class=\"language-text\">–info</code>或者<code class=\"language-text\">-debug</code>一起执行查看日志</li>\n</ul>\n<blockquote>\n<p>注意：</p>\n</blockquote>\n<h2>Part 2 - 安装</h2>\n<blockquote>\n<p>如果是私有项目还需要生成一个<code class=\"language-text\">read:packages</code>的 Token，生成步骤见 Part 1</p>\n</blockquote>\n<h3>Step 1 - 更新项目的根 build.gradle</h3>\n<ul>\n<li>将下方代码添加到根 build.gradle 文件</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"gradle\"><pre class=\"language-gradle\"><code class=\"language-gradle\">allprojects {\n    repositories {\n        maven {\n          name = &quot;GitHubPackages&quot;\n          /**\n          ** GITHUB_USERID替换成刚才发布包的GitHub账号Id\n          ** REPOSITORY替换成刚才发布包的项目名称\n          */\n          url = uri(&quot;https://maven.pkg.github.com/GITHUB_USERID/REPOSITORY&quot;)\n        }\n    }\n}</code></pre></div>\n<ul>\n<li>添加依赖到 app.module 文件</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"gradle\"><pre class=\"language-gradle\"><code class=\"language-gradle\">dependencies {\n  implementation &#39;com.example:package&#39;\n}</code></pre></div>\n<ul>\n<li>同步</li>\n</ul>\n<h2>Part 3 - 便携发布</h2>\n<div class=\"gatsby-highlight\" data-language=\"gradle\"><pre class=\"language-gradle\"><code class=\"language-gradle\">apply from: &#39;https://raw.githubusercontent.com/izyhang/GitHub-Packages-Publish/master/publish.gradle&#39;</code></pre></div>","frontmatter":{"title":"发布Android库到GitHub Packages","date":"March 09, 2020","tags":["libraries","gradle","github packages"],"categories":"Android"}}},"pageContext":{"slug":"/fa-bu-android-ku-dao-github-packages/","previous":{"excerpt":". 前言 这两个星期是我最完整的一次全栈开发经历，前端，后端，服务器，域名。虽然之前也搭过服务器（本博客网站），但是这次也遇到了些许问题，包括、、等等，让我慢慢一一道来 eggjs…","fields":{"slug":"/qianqianqianhouhouhou/"},"frontmatter":{"date":"February 29, 2020","title":"前前前后后后","tags":["eggjs","sqeuelize","github actions"],"categories":"Backend"}},"next":{"excerpt":"支付宝小程序支持从外部调起，具体做法是通过，如下 appId 是小程序唯一 Id pagePath 是页面路径，也就是本文要讲的，不带则跳首页 params 是额外参数 更多信息请前往官网\nhttps://opensupport.alipay.com/support…","fields":{"slug":"/alipay-tinyapp-zhi-ding-ye-mian-tiao-zhuan/"},"frontmatter":{"date":"March 11, 2020","title":"支付宝小程序指定页面跳转","tags":["alipay","tinyapp","route"],"categories":"Android"}}}},"staticQueryHashes":["2841359383"]}